<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>ASN1_item_sign</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#RETURN-VALUES">RETURN VALUES</a></li>
  <li><a href="#EXAMPLES">EXAMPLES</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#HISTORY">HISTORY</a></li>
  <li><a href="#COPYRIGHT">COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>ASN1_item_sign, ASN1_item_sign_ex, ASN1_item_sign_ctx, ASN1_item_verify, ASN1_item_verify_ex, ASN1_item_verify_ctx - ASN1 sign and verify</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code> <span class="comment">#include &lt;openssl/x509.h&gt;</span>
 
 <span class="keyword">int</span> <span class="variable">ASN1_item_sign_ex</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">ASN1_ITEM</span> <span class="variable">*it</span><span class="operator">,</span> <span class="variable">X509_ALGOR</span> <span class="variable">*algor1</span><span class="operator">,</span>
                       <span class="variable">X509_ALGOR</span> <span class="variable">*algor2</span><span class="operator">,</span> <span class="variable">ASN1_BIT_STRING</span> <span class="variable">*signature</span><span class="operator">,</span>
                       <span class="variable">const</span> <span class="variable">void</span> <span class="variable">*data</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">ASN1_OCTET_STRING</span> <span class="variable">*id</span><span class="operator">,</span>
                       <span class="variable">EVP_PKEY</span> <span class="variable">*pkey</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">EVP_MD</span> <span class="variable">*md</span><span class="operator">,</span> <span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span>
                       <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*propq</span><span class="operator">);</span>
 
 <span class="keyword">int</span> <span class="variable">ASN1_item_sign</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">ASN1_ITEM</span> <span class="variable">*it</span><span class="operator">,</span> <span class="variable">X509_ALGOR</span> <span class="variable">*algor1</span><span class="operator">,</span> <span class="variable">X509_ALGOR</span> <span class="variable">*algor2</span><span class="operator">,</span>
                    <span class="variable">ASN1_BIT_STRING</span> <span class="variable">*signature</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">void</span> <span class="variable">*data</span><span class="operator">,</span>
                    <span class="variable">EVP_PKEY</span> <span class="variable">*pkey</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">EVP_MD</span> <span class="variable">*md</span><span class="operator">);</span>
 
 <span class="keyword">int</span> <span class="variable">ASN1_item_sign_ctx</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">ASN1_ITEM</span> <span class="variable">*it</span><span class="operator">,</span> <span class="variable">X509_ALGOR</span> <span class="variable">*algor1</span><span class="operator">,</span>
                        <span class="variable">X509_ALGOR</span> <span class="variable">*algor2</span><span class="operator">,</span> <span class="variable">ASN1_BIT_STRING</span> <span class="variable">*signature</span><span class="operator">,</span>
                        <span class="variable">const</span> <span class="variable">void</span> <span class="variable">*data</span><span class="operator">,</span> <span class="variable">EVP_MD_CTX</span> <span class="variable">*ctx</span><span class="operator">);</span>
 
 <span class="keyword">int</span> <span class="variable">ASN1_item_verify_ex</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">ASN1_ITEM</span> <span class="variable">*it</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">X509_ALGOR</span> <span class="variable">*alg</span><span class="operator">,</span>
                         <span class="variable">const</span> <span class="variable">ASN1_BIT_STRING</span> <span class="variable">*signature</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">void</span> <span class="variable">*data</span><span class="operator">,</span>
                         <span class="variable">const</span> <span class="variable">ASN1_OCTET_STRING</span> <span class="variable">*id</span><span class="operator">,</span> <span class="variable">EVP_PKEY</span> <span class="variable">*pkey</span><span class="operator">,</span>
                         <span class="variable">OSSL_LIB_CTX</span> <span class="variable">*libctx</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">char</span> <span class="variable">*propq</span><span class="operator">);</span>
 
 <span class="keyword">int</span> <span class="variable">ASN1_item_verify</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">ASN1_ITEM</span> <span class="variable">*it</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">X509_ALGOR</span> <span class="variable">*alg</span><span class="operator">,</span>
                      <span class="variable">const</span> <span class="variable">ASN1_BIT_STRING</span> <span class="variable">*signature</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">void</span> <span class="variable">*data</span><span class="operator">,</span>
                      <span class="variable">EVP_PKEY</span> <span class="variable">*pkey</span><span class="operator">);</span>
 
 <span class="keyword">int</span> <span class="variable">ASN1_item_verify_ctx</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">ASN1_ITEM</span> <span class="variable">*it</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">X509_ALGOR</span> <span class="variable">*alg</span><span class="operator">,</span>
                          <span class="variable">const</span> <span class="variable">ASN1_BIT_STRING</span> <span class="variable">*signature</span><span class="operator">,</span> <span class="variable">const</span> <span class="variable">void</span> <span class="variable">*data</span><span class="operator">,</span>
                          <span class="variable">EVP_MD_CTX</span> <span class="variable">*ctx</span><span class="operator">);</span>
</code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>ASN1_item_sign_ex() is used to sign arbitrary ASN1 data using a data object <i>data</i>, the ASN.1 structure <i>it</i>, private key <i>pkey</i> and message digest <i>md</i>. The data that is signed is formed by taking the data object in <i>data</i> and converting it to der format using the ASN.1 structure <i>it</i>. The <i>data</i> that will be signed, and a structure containing the signature may both have a copy of the <b>X509_ALGOR</b>. The ASN1_item_sign_ex() function will write the correct <b>X509_ALGOR</b> to the structs based on the algorithms and parameters that have been set up. If one of <i>algor1</i> or <i>algor2</i> points to the <b>X509_ALGOR</b> of the <i>data</i> to be signed, then that <b>X509_ALGOR</b> will first be written before the signature is generated. Examples of valid values that can be used by the ASN.1 structure <i>it</i> are ASN1_ITEM_rptr(X509_CINF), ASN1_ITEM_rptr(X509_REQ_INFO) and ASN1_ITEM_rptr(X509_CRL_INFO). The <b>OSSL_LIB_CTX</b> specified in <i>libctx</i> and the property query string specified in <i>props</i> are used when searching for algorithms in providers. The generated signature is set into <i>signature</i>. The optional parameter <i>id</i> can be NULL, but can be set for special key types. See EVP_PKEY_CTX_set1_id() for further info. The output parameters &lt;algor1&gt; and <i>algor2</i> are ignored if they are NULL.</p>

<p>ASN1_item_sign() is similar to ASN1_item_sign_ex() but uses default values of NULL for the <i>id</i>, <i>libctx</i> and <i>propq</i>.</p>

<p>ASN1_item_sign_ctx() is similar to ASN1_item_sign() but uses the parameters contained in digest context <i>ctx</i>.</p>

<p>ASN1_item_verify_ex() is used to verify the signature <i>signature</i> of internal data <i>data</i> using the public key <i>pkey</i> and algorithm identifier <i>alg</i>. The data that is verified is formed by taking the data object in <i>data</i> and converting it to der format using the ASN.1 structure <i>it</i>. The <b>OSSL_LIB_CTX</b> specified in <i>libctx</i> and the property query string specified in <i>props</i> are used when searching for algorithms in providers. The optional parameter <i>id</i> can be NULL, but can be set for special key types. See EVP_PKEY_CTX_set1_id() for further info.</p>

<p>ASN1_item_verify() is similar to ASN1_item_verify_ex() but uses default values of NULL for the <i>id</i>, <i>libctx</i> and <i>propq</i>.</p>

<p>ASN1_item_verify_ctx() is similar to ASN1_item_verify() but uses the parameters contained in digest context <i>ctx</i>.</p>

<h1 id="RETURN-VALUES">RETURN VALUES</h1>

<p>All sign functions return the size of the signature in bytes for success and zero for failure.</p>

<p>All verify functions return 1 if the signature is valid and 0 if the signature check fails. If the signature could not be checked at all because it was ill-formed or some other error occurred then -1 is returned.</p>

<h1 id="EXAMPLES">EXAMPLES</h1>

<p>In the following example a &#39;MyObject&#39; object is signed using the key contained in an EVP_MD_CTX. The signature is written to MyObject.signature. The object is then output in DER format and then loaded back in and verified.</p>

<pre><code> <span class="comment">#include &lt;openssl/x509.h&gt;</span>
 <span class="comment">#include &lt;openssl/asn1t.h&gt;</span>
 
 <span class="regex">/* An object used to store the ASN1 data fields that will be signed */</span>
 <span class="variable">typedef</span> <span class="variable">struct</span> <span class="variable">MySignInfoObject_st</span>
 <span class="operator">{</span>
     <span class="variable">ASN1_INTEGER</span> <span class="variable">*version</span><span class="operator">;</span>
     <span class="variable">X509_ALGOR</span> <span class="variable">sig_alg</span><span class="operator">;</span>
 <span class="operator">}</span> <span class="variable">MySignInfoObject</span><span class="operator">;</span>
 
 <span class="variable">DECLARE_ASN1_FUNCTIONS</span><span class="operator">(</span><span class="variable">MySignInfoObject</span><span class="operator">)</span>
 <span class="operator">/*</span>
  <span class="operator">*</span> <span class="variable">A</span> <span class="variable">higher</span> <span class="variable">level</span> <span class="variable">object</span> <span class="variable">containing</span> <span class="variable">the</span> <span class="variable">ASN1</span> <span class="variable">fields</span><span class="operator">,</span> <span class="variable">signature</span> <span class="variable">alg</span> <span class="keyword">and</span>
  <span class="operator">*</span> <span class="variable">output</span> <span class="variable">signature</span><span class="operator">.</span>
  <span class="operator">*</span><span class="regex">/
 typedef struct MyObject_st
 {
     MySignInfoObject info;
     X509_ALGOR sig_alg;
     ASN1_BIT_STRING *signature;
 } MyObject;
 
 DECLARE_ASN1_FUNCTIONS(MyObject)
 
 /</span><span class="operator">*</span> <span class="variable">The</span> <span class="variable">ASN1</span> <span class="variable">definition</span> <span class="variable">of</span> <span class="variable">MySignInfoObject</span> <span class="operator">*/</span>
 <span class="variable">ASN1_SEQUENCE_cb</span><span class="operator">(</span><span class="variable">MySignInfoObject</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">)</span> <span class="operator">=</span> <span class="operator">{</span>
     <span class="variable">ASN1_SIMPLE</span><span class="operator">(</span><span class="variable">MySignInfoObject</span><span class="operator">,</span> <span class="variable">version</span><span class="operator">,</span> <span class="variable">ASN1_INTEGER</span><span class="operator">)</span>
     <span class="variable">ASN1_EMBED</span><span class="operator">(</span><span class="variable">MySignInfoObject</span><span class="operator">,</span> <span class="variable">sig_alg</span><span class="operator">,</span> <span class="variable">X509_ALGOR</span><span class="operator">),</span>
 <span class="operator">}</span> <span class="variable">ASN1_SEQUENCE_END_cb</span><span class="operator">(</span><span class="variable">MySignInfoObject</span><span class="operator">,</span> <span class="variable">MySignInfoObject</span><span class="operator">)</span>
 
 <span class="operator">/*</span> <span class="variable">new</span><span class="operator">,</span> <span class="variable">free</span><span class="operator">,</span> <span class="variable">d2i</span> <span class="operator">&amp;</span> <span class="variable">i2d</span> <span class="variable">functions</span> <span class="keyword">for</span> <span class="variable">MySignInfoObject</span> <span class="operator">*/</span>
 <span class="variable">IMPLEMENT_ASN1_FUNCTIONS</span><span class="operator">(</span><span class="variable">MySignInfoObject</span><span class="operator">)</span>
 
 <span class="operator">/*</span> <span class="variable">The</span> <span class="variable">ASN1</span> <span class="variable">definition</span> <span class="variable">of</span> <span class="variable">MyObject</span> <span class="operator">*/</span>
 <span class="variable">ASN1_SEQUENCE_cb</span><span class="operator">(</span><span class="variable">MyObject</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">)</span> <span class="operator">=</span> <span class="operator">{</span>
     <span class="variable">ASN1_EMBED</span><span class="operator">(</span><span class="variable">MyObject</span><span class="operator">,</span> <span class="variable">info</span><span class="operator">,</span> <span class="variable">MySignInfoObject</span><span class="operator">),</span>
     <span class="variable">ASN1_EMBED</span><span class="operator">(</span><span class="variable">MyObject</span><span class="operator">,</span> <span class="variable">sig_alg</span><span class="operator">,</span> <span class="variable">X509_ALGOR</span><span class="operator">),</span>
     <span class="variable">ASN1_SIMPLE</span><span class="operator">(</span><span class="variable">MyObject</span><span class="operator">,</span> <span class="variable">signature</span><span class="operator">,</span> <span class="variable">ASN1_BIT_STRING</span><span class="operator">)</span>
 <span class="operator">}</span> <span class="variable">ASN1_SEQUENCE_END_cb</span><span class="operator">(</span><span class="variable">MyObject</span><span class="operator">,</span> <span class="variable">MyObject</span><span class="operator">)</span>
 
 <span class="operator">/*</span> <span class="variable">new</span><span class="operator">,</span> <span class="variable">free</span><span class="operator">,</span> <span class="variable">d2i</span> <span class="operator">&amp;</span> <span class="variable">i2d</span> <span class="variable">functions</span> <span class="keyword">for</span> <span class="variable">MyObject</span> <span class="operator">*/</span>
 <span class="variable">IMPLEMENT_ASN1_FUNCTIONS</span><span class="operator">(</span><span class="variable">MyObject</span><span class="operator">)</span>
 
 <span class="keyword">int</span> <span class="variable">test_asn1_item_sign_verify</span><span class="operator">(</span><span class="variable">const</span> <span class="variable">char</span> <span class="variable">*mdname</span><span class="operator">,</span> <span class="variable">EVP_PKEY</span> <span class="variable">*pkey</span><span class="operator">,</span> <span class="variable">long</span> <span class="variable">version</span><span class="operator">)</span>
 <span class="operator">{</span>
    <span class="keyword">int</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">;</span>
    <span class="variable">unsigned</span> <span class="variable">char</span> <span class="variable">*obj_der</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
    <span class="variable">const</span> <span class="variable">unsigned</span> <span class="variable">char</span> <span class="variable">*p</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
    <span class="variable">MyObject</span> <span class="variable">*obj</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">,</span> <span class="variable">*loaded_obj</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
    <span class="variable">const</span> <span class="variable">ASN1_ITEM</span> <span class="variable">*it</span> <span class="operator">=</span> <span class="variable">ASN1_ITEM_rptr</span><span class="operator">(</span><span class="variable">MySignInfoObject</span><span class="operator">);</span>
    <span class="variable">EVP_MD_CTX</span> <span class="variable">*sctx</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">,</span> <span class="variable">*vctx</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
    <span class="keyword">int</span> <span class="variable">len</span><span class="operator">;</span>
 
    <span class="regex">/* Create MyObject and set its version */</span>
    <span class="variable">obj</span> <span class="operator">=</span> <span class="variable">MyObject_new</span><span class="operator">();</span>
    <span class="keyword">if</span> <span class="operator">(</span><span class="variable">obj</span> <span class="operator">==</span> <span class="variable">NULL</span><span class="operator">)</span>
        <span class="keyword">goto</span> <span class="variable">err</span><span class="operator">;</span>
    <span class="keyword">if</span> <span class="operator">(!</span><span class="variable">ASN1_INTEGER_set</span><span class="operator">(</span><span class="variable">obj</span><span class="operator">-&gt;</span><span class="variable">info</span><span class="operator">.</span><span class="variable">version</span><span class="operator">,</span> <span class="variable">version</span><span class="operator">))</span>
        <span class="keyword">goto</span> <span class="variable">err</span><span class="operator">;</span>
 
    <span class="regex">/* Set the key and digest used for signing */</span>
    <span class="variable">sctx</span> <span class="operator">=</span> <span class="variable">EVP_MD_CTX_new</span><span class="operator">();</span>
    <span class="keyword">if</span> <span class="operator">(</span><span class="variable">sctx</span> <span class="operator">==</span> <span class="variable">NULL</span>
        <span class="operator">||</span> <span class="operator">!</span><span class="variable">EVP_DigestSignInit_ex</span><span class="operator">(</span><span class="variable">sctx</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">,</span> <span class="variable">mdname</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">,</span> <span class="variable">pkey</span><span class="operator">))</span>
        <span class="keyword">goto</span> <span class="variable">err</span><span class="operator">;</span>
 
    <span class="regex">/*
     * it contains the mapping between ASN.1 data and an object MySignInfoObject
     * obj-&gt;info is the 'MySignInfoObject' object that will be
     *   converted into DER data and then signed.
     * obj-&gt;signature will contain the output signature.
     * obj-&gt;sig_alg is filled with the private key's signing algorithm id.
     * obj-&gt;info.sig_alg is another copy of the signing algorithm id that sits
     * within MyObject.
     */</span>
    <span class="variable">len</span> <span class="operator">=</span> <span class="variable">ASN1_item_sign_ctx</span><span class="operator">(</span><span class="variable">it</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">obj</span><span class="operator">-&gt;</span><span class="variable">sig_alg</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">obj</span><span class="operator">-&gt;</span><span class="variable">info</span><span class="operator">.</span><span class="variable">sig_alg</span><span class="operator">,</span>
                             <span class="variable">obj</span><span class="operator">-&gt;</span><span class="variable">signature</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">obj</span><span class="operator">-&gt;</span><span class="variable">info</span><span class="operator">,</span> <span class="variable">sctx</span><span class="operator">);</span>
    <span class="keyword">if</span> <span class="operator">(</span><span class="variable">len</span> <span class="operator">&lt;=</span> <span class="number">0</span>
        <span class="operator">||</span> <span class="variable">X509_ALGOR_cmp</span><span class="operator">(&amp;</span><span class="variable">obj</span><span class="operator">-&gt;</span><span class="variable">sig_alg</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">obj</span><span class="operator">-&gt;</span><span class="variable">info</span><span class="operator">.</span><span class="variable">sig_alg</span><span class="operator">)</span> <span class="operator">!=</span> <span class="number">0</span><span class="operator">)</span>
        <span class="keyword">goto</span> <span class="variable">err</span><span class="operator">;</span>
 
    <span class="regex">/* Output MyObject in der form */</span>
    <span class="variable">len</span> <span class="operator">=</span> <span class="variable">i2d_MyObject</span><span class="operator">(</span><span class="variable">obj</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">obj_der</span><span class="operator">);</span>
    <span class="keyword">if</span> <span class="operator">(</span><span class="variable">len</span> <span class="operator">&lt;=</span> <span class="number">0</span><span class="operator">)</span>
        <span class="keyword">goto</span> <span class="variable">err</span><span class="operator">;</span>
 
    <span class="regex">/* Set the key and digest used for verifying */</span>
    <span class="variable">vctx</span> <span class="operator">=</span> <span class="variable">EVP_MD_CTX_new</span><span class="operator">();</span>
    <span class="keyword">if</span> <span class="operator">(</span><span class="variable">vctx</span> <span class="operator">==</span> <span class="variable">NULL</span>
        <span class="operator">||</span> <span class="operator">!</span><span class="variable">EVP_DigestVerifyInit_ex</span><span class="operator">(</span><span class="variable">vctx</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">,</span> <span class="variable">mdname</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">,</span> <span class="variable">pkey</span><span class="operator">))</span>
        <span class="keyword">goto</span> <span class="variable">err</span><span class="operator">;</span>
 
    <span class="regex">/* Load the der data back into an object */</span>
    <span class="variable">p</span> <span class="operator">=</span> <span class="variable">obj_der</span><span class="operator">;</span>
    <span class="variable">loaded_obj</span> <span class="operator">=</span> <span class="variable">d2i_MyObject</span><span class="operator">(</span><span class="variable">NULL</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">p</span><span class="operator">,</span> <span class="variable">len</span><span class="operator">);</span>
    <span class="keyword">if</span> <span class="operator">(</span><span class="variable">loaded_obj</span> <span class="operator">==</span> <span class="variable">NULL</span><span class="operator">)</span>
        <span class="keyword">goto</span> <span class="variable">err</span><span class="operator">;</span>
    <span class="regex">/* Verify the loaded object */</span>
    <span class="variable">ret</span> <span class="operator">=</span> <span class="variable">ASN1_item_verify_ctx</span><span class="operator">(</span><span class="variable">it</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">loaded_obj</span><span class="operator">-&gt;</span><span class="variable">sig_alg</span><span class="operator">,</span> <span class="variable">loaded_obj</span><span class="operator">-&gt;</span><span class="variable">signature</span><span class="operator">,</span>
                               <span class="operator">&amp;</span><span class="variable">loaded_obj</span><span class="operator">-&gt;</span><span class="variable">info</span><span class="operator">,</span> <span class="variable">vctx</span><span class="operator">);</span>
 <span class="variable">err</span><span class="operator">:</span>
    <span class="variable">OPENSSL_free</span><span class="operator">(</span><span class="variable">obj_der</span><span class="operator">);</span>
    <span class="variable">MyObject_free</span><span class="operator">(</span><span class="variable">loaded_obj</span><span class="operator">);</span>
    <span class="variable">MyObject_free</span><span class="operator">(</span><span class="variable">obj</span><span class="operator">);</span>
    <span class="variable">EVP_MD_CTX_free</span><span class="operator">(</span><span class="variable">sctx</span><span class="operator">);</span>
    <span class="variable">EVP_MD_CTX_free</span><span class="operator">(</span><span class="variable">vctx</span><span class="operator">);</span>
    <span class="keyword">return</span> <span class="variable">ret</span><span class="operator">;</span>
 <span class="operator">}</span>
</code></pre>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p><a href="../man3/X509_sign.html">X509_sign(3)</a>, <a href="../man3/X509_verify.html">X509_verify(3)</a></p>

<h1 id="HISTORY">HISTORY</h1>

<p>ASN1_item_sign_ex() and ASN1_item_verify_ex() were added in OpenSSL 3.0.</p>

<h1 id="COPYRIGHT">COPYRIGHT</h1>

<p>Copyright 2020-2022 The OpenSSL Project Authors. All Rights Reserved.</p>

<p>Licensed under the Apache License 2.0 (the &quot;License&quot;). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at <a href="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</a>.</p>


</body>

</html>


