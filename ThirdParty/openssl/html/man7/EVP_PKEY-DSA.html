<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>EVP_PKEY-DSA</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:" />
</head>

<body>



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a>
    <ul>
      <li><a href="#DSA-parameters">DSA parameters</a></li>
      <li><a href="#DSA-key-generation-parameters">DSA key generation parameters</a></li>
      <li><a href="#DSA-key-validation">DSA key validation</a></li>
    </ul>
  </li>
  <li><a href="#EXAMPLES">EXAMPLES</a></li>
  <li><a href="#CONFORMING-TO">CONFORMING TO</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
  <li><a href="#HISTORY">HISTORY</a></li>
  <li><a href="#COPYRIGHT">COPYRIGHT</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>EVP_PKEY-DSA, EVP_KEYMGMT-DSA - EVP_PKEY DSA keytype and algorithm support</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>For <b>DSA</b> the FIPS 186-4 standard specifies that the values used for FFC parameter generation are also required for parameter validation. This means that optional FFC domain parameter values for <i>seed</i>, <i>pcounter</i> and <i>gindex</i> may need to be stored for validation purposes. For <b>DSA</b> these fields are not stored in the ASN1 data so they need to be stored externally if validation is required.</p>

<p>As part of FIPS 140-3 DSA is not longer FIPS approved for key generation and signature validation, but is still allowed for signature verification.</p>

<h2 id="DSA-parameters">DSA parameters</h2>

<p>The <b>DSA</b> key type supports the FFC parameters (see <a href="../man7/EVP_PKEY-FFC.html">&quot;FFC parameters&quot; in EVP_PKEY-FFC(7)</a>).</p>

<p>It also supports the following parameters:</p>

<dl>

<dt id="sign-check-OSSL_PKEY_PARAM_FIPS_SIGN_CHECK-integer">&quot;sign-check&quot; (<b>OSSL_PKEY_PARAM_FIPS_SIGN_CHECK</b>) &lt;integer</dt>
<dd>

</dd>
<dt id="fips-indicator-OSSL_PKEY_PARAM_FIPS_APPROVED_INDICATOR-integer">&quot;fips-indicator&quot; (<b>OSSL_PKEY_PARAM_FIPS_APPROVED_INDICATOR</b>) &lt;integer&gt;</dt>
<dd>

<p>See <a href="../man7/provider-keymgmt.html">&quot;Common Information Parameters&quot; in provider-keymgmt(7)</a> for more information.</p>

</dd>
</dl>

<h2 id="DSA-key-generation-parameters">DSA key generation parameters</h2>

<p>The <b>DSA</b> key type supports the FFC key generation parameters (see <a href="../man7/EVP_PKEY-FFC.html">&quot;FFC key generation parameters&quot; in EVP_PKEY-FFC(7)</a></p>

<p>The following restrictions apply to the &quot;pbits&quot; field:</p>

<p>For &quot;fips186_4&quot; this must be either 2048 or 3072. For &quot;fips186_2&quot; this must be 1024. For &quot;group&quot; this can be any one of 2048, 3072, 4096, 6144 or 8192.</p>

<h2 id="DSA-key-validation">DSA key validation</h2>

<p>For DSA keys, <a href="../man3/EVP_PKEY_param_check.html">EVP_PKEY_param_check(3)</a> behaves in the following way: The OpenSSL FIPS provider conforms to the rules within the FIPS186-4 standard for FFC parameter validation. For backwards compatibility the OpenSSL default provider uses a much simpler check (see below) for parameter validation, unless the seed parameter is set.</p>

<p>For DSA keys, <a href="../man3/EVP_PKEY_param_check_quick.html">EVP_PKEY_param_check_quick(3)</a> behaves in the following way: A simple check of L and N and partial g is performed. The default provider also supports validation of legacy &quot;fips186_2&quot; keys.</p>

<p>For DSA keys, <a href="../man3/EVP_PKEY_public_check.html">EVP_PKEY_public_check(3)</a>, <a href="../man3/EVP_PKEY_private_check.html">EVP_PKEY_private_check(3)</a> and <a href="../man3/EVP_PKEY_pairwise_check.html">EVP_PKEY_pairwise_check(3)</a> the OpenSSL default and FIPS providers conform to the rules within SP800-56Ar3 for public, private and pairwise tests respectively.</p>

<h1 id="EXAMPLES">EXAMPLES</h1>

<p>An <b>EVP_PKEY</b> context can be obtained by calling:</p>

<pre><code>    <span class="variable">EVP_PKEY_CTX</span> <span class="variable">*pctx</span> <span class="operator">=</span> <span class="variable">EVP_PKEY_CTX_new_from_name</span><span class="operator">(</span><span class="variable">NULL</span><span class="operator">,</span> <span class="string">"DSA"</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
</code></pre>

<p>The <b>DSA</b> domain parameters can be generated by calling:</p>

<pre><code>    <span class="variable">unsigned</span> <span class="keyword">int</span> <span class="variable">pbits</span> <span class="operator">=</span> <span class="number">2048</span><span class="operator">;</span>
    <span class="variable">unsigned</span> <span class="keyword">int</span> <span class="variable">qbits</span> <span class="operator">=</span> <span class="number">256</span><span class="operator">;</span>
    <span class="keyword">int</span> <span class="variable">gindex</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">;</span>
    <span class="variable">OSSL_PARAM</span> <span class="variable">params</span><span class="operator">[</span><span class="number">5</span><span class="operator">]</span><span class="operator">;</span>
    <span class="variable">EVP_PKEY</span> <span class="variable">*param_key</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
    <span class="variable">EVP_PKEY_CTX</span> <span class="variable">*pctx</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
    
    <span class="variable">pctx</span> <span class="operator">=</span> <span class="variable">EVP_PKEY_CTX_new_from_name</span><span class="operator">(</span><span class="variable">NULL</span><span class="operator">,</span> <span class="string">"DSA"</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_paramgen_init</span><span class="operator">(</span><span class="variable">pctx</span><span class="operator">);</span>
    
    <span class="variable">params</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">OSSL_PARAM_construct_uint</span><span class="operator">(</span><span class="string">"pbits"</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">pbits</span><span class="operator">);</span>
    <span class="variable">params</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">OSSL_PARAM_construct_uint</span><span class="operator">(</span><span class="string">"qbits"</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">qbits</span><span class="operator">);</span>
    <span class="variable">params</span><span class="operator">[</span><span class="number">2</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">OSSL_PARAM_construct_int</span><span class="operator">(</span><span class="string">"gindex"</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">gindex</span><span class="operator">);</span>
    <span class="variable">params</span><span class="operator">[</span><span class="number">3</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">OSSL_PARAM_construct_utf8_string</span><span class="operator">(</span><span class="string">"digest"</span><span class="operator">,</span> <span class="string">"SHA384"</span><span class="operator">,</span> <span class="number">0</span><span class="operator">);</span>
    <span class="variable">params</span><span class="operator">[</span><span class="number">4</span><span class="operator">]</span> <span class="operator">=</span> <span class="variable">OSSL_PARAM_construct_end</span><span class="operator">();</span>
    <span class="variable">EVP_PKEY_CTX_set_params</span><span class="operator">(</span><span class="variable">pctx</span><span class="operator">,</span> <span class="variable">params</span><span class="operator">);</span>
    
    <span class="variable">EVP_PKEY_generate</span><span class="operator">(</span><span class="variable">pctx</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">param_key</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_CTX_free</span><span class="operator">(</span><span class="variable">pctx</span><span class="operator">);</span>
    
    <span class="variable">EVP_PKEY_print_params</span><span class="operator">(</span><span class="variable">bio_out</span><span class="operator">,</span> <span class="variable">param_key</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
</code></pre>

<p>A <b>DSA</b> key can be generated using domain parameters by calling:</p>

<pre><code>    <span class="variable">EVP_PKEY</span> <span class="variable">*key</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
    <span class="variable">EVP_PKEY_CTX</span> <span class="variable">*gctx</span> <span class="operator">=</span> <span class="variable">NULL</span><span class="operator">;</span>
    
    <span class="variable">gctx</span> <span class="operator">=</span> <span class="variable">EVP_PKEY_CTX_new_from_pkey</span><span class="operator">(</span><span class="variable">NULL</span><span class="operator">,</span> <span class="variable">param_key</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_keygen_init</span><span class="operator">(</span><span class="variable">gctx</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_generate</span><span class="operator">(</span><span class="variable">gctx</span><span class="operator">,</span> <span class="operator">&amp;</span><span class="variable">key</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_CTX_free</span><span class="operator">(</span><span class="variable">gctx</span><span class="operator">);</span>
    <span class="variable">EVP_PKEY_print_private</span><span class="operator">(</span><span class="variable">bio_out</span><span class="operator">,</span> <span class="variable">key</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="variable">NULL</span><span class="operator">);</span>
</code></pre>

<h1 id="CONFORMING-TO">CONFORMING TO</h1>

<p>The following sections of FIPS186-4:</p>

<dl>

<dt id="A.1.1.2-Generation-of-Probable-Primes-p-and-q-Using-an-Approved-Hash-Function">A.1.1.2 Generation of Probable Primes p and q Using an Approved Hash Function.</dt>
<dd>

</dd>
<dt id="A.2.3-Generation-of-canonical-generator-g">A.2.3 Generation of canonical generator g.</dt>
<dd>

</dd>
<dt id="A.2.1-Unverifiable-Generation-of-the-Generator-g">A.2.1 Unverifiable Generation of the Generator g.</dt>
<dd>

</dd>
</dl>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p><a href="../man7/EVP_PKEY-FFC.html">EVP_PKEY-FFC(7)</a>, <a href="../man7/EVP_SIGNATURE-DSA.html">EVP_SIGNATURE-DSA(7)</a> <a href="../man3/EVP_PKEY.html">EVP_PKEY(3)</a>, <a href="../man7/provider-keymgmt.html">provider-keymgmt(7)</a>, <a href="../man3/EVP_KEYMGMT.html">EVP_KEYMGMT(3)</a>, <a href="../man7/OSSL_PROVIDER-default.html">OSSL_PROVIDER-default(7)</a>, <a href="../man7/OSSL_PROVIDER-FIPS.html">OSSL_PROVIDER-FIPS(7)</a></p>

<h1 id="HISTORY">HISTORY</h1>

<p>DSA Key generation and signature generation are no longer FIPS approved in OpenSSL 3.4. See <a href="../man7/fips_module.html">&quot;FIPS indicators&quot; in fips_module(7)</a> for more information.</p>

<h1 id="COPYRIGHT">COPYRIGHT</h1>

<p>Copyright 2020-2024 The OpenSSL Project Authors. All Rights Reserved.</p>

<p>Licensed under the Apache License 2.0 (the &quot;License&quot;). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at <a href="https://www.openssl.org/source/license.html">https://www.openssl.org/source/license.html</a>.</p>


</body>

</html>


